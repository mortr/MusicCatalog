# MusicCatalog

**Описание**


Приложение предназаначено для получения и отображения справочной информации об исполнителях музыкальных произведений.
Файл источник информации расположен по адрессу http://download.cdn.yandex.net/mobilization-2016/artists.json


Приложение состоит из двух экранов. Первый экран представляет собой список исполнителей отсортированных в алфавитном порядке.
При нажатии на элемент списка,открывается второй экран. Второй экран содержит более подробную информацию об исполнителе. Стрелка 
в панели действий, дублирует системную кнопку "Назад", и возвращает пользователя на  первый экран со списком исполнителей.
Для корректной работы приложения необходимо наличие подключения к сети Интернет. Это необходимо для первичного скачивания и периодического
обновления информации до актуальной версии. Обновление происходит во время начала нового сеанса, при условии окончания определенного срока со времени последнего обновления.
Подкачка графической информации, с целью экономии времени и трафика, происходит по мере необходимости.
Пользователь может досрочно получить обновление используя механизм  SwipeRefresh на первом экране приложения.
При отсутствии соединения с сетью, остается возможность использовать приложение, с данными полученными при предыдущем подключении (в частности, изображения будут 
отображаться только те, которые просматривались при наличии сети). 
Кэш устройства может быть очищен ОС или ользователем, в случае необходимости освобождения ресурсов. В этом случае, часть информации может не отображаться.

**Особенности реализации**

При начале работы приложения, запускается  Activity, которая является хостовой для фрагмента,  отображающего список исполнителей.
Эта Activity реализует метод setItem(long itemId,String...params) интерфейса ArtistsListFragment.IListItemSettable, в котором  происходит запуск Activity 
с подробной информацией об исполнителе (интент содержит ID и Name выбранного элемента списка,полученные параметрами метода).
Во фрагменте, отвечающем за отображение списка исполнителей (посредством RecyclerView и кастомного адаптера) организованы
запрос к  DataManager (управляет доступом к данным) для получения информации для адаптера и  механизм обновления данных посредством SwipeRefresh.
Обращение за данными происходит в отдельном потоке, посредством Loader. Фрагмент подписан на обновления DataManager и 
реализует метод update(boolean successLoad), который  в случае успешной загрузки данных из сети запускает механизм получения данных для адаптера.


 DataManager отвечает за получение и сохранение данных.
 Полученние из сети данных происходит посредством ServiceHelper(сетевой запрос при помощи библиотеки Retrofit, перевод данных из JSON в модель-- при помощи GSON).
 Результат Retrofit запроса передаем методом setData интерфейса IDataSettable, который реализует DataManager. В этом методе реализуется  запись данных в базу данных 
 (при помощи SQLiteOpenHelper) в отдельном потоке, созданном посредством AsyncTask. После записи в базу данных,в SharedPreferences обновляется время последнего обновления,
 оповещаются подписчики  DataManager. (**NOTE** Обращение к сети происходит в случае превышения установленного срока со времени последнего обновления либо при Swipe списка.
 При отсутствии соединения с сетью, запрос за данными к сети произодиться не будет). До обновления данных DataManager возвращает содержимое базы данных(при помощи SQLiteOpenHelper).

В Activity, запущенной для отображения информации об отдельном исполнителе, в тулбаре устанавливается Имя исполнителя полученного из  Intent, устанавливается "навигационная стрелка"(поведение
при нажатии, дублирует поведение при нажатии системной кнопки "Back"),создается и запускается фрагмент с ID исполнителя. Фрагмент получает отображаемые данные из базы данных в отдельном потоке,
созданном при помощи Loader, и подписан на обновление данныхв DataManager.
Отображение и кэширование изображений, происходит при помощи библиотеки Fresco (путем передачи в SimpleDraweeView соответствующей ссылки из сохраненных данных).